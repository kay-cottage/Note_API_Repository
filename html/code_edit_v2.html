<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI 增量代码编辑器</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-6nrpVfrV+zYgRv1+Vq0Lf+Z7iQWkxVJZfQzMEyD0QOj1pjcxslXqZAk/pVbr3YTvL4onD3+G0VM3OtCWyhX/YA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body class="flex flex-col h-screen bg-gray-900 text-gray-200 overflow-hidden font-sans">
  <!-- Toast -->
  <div id="toast" class="fixed bottom-5 left-1/2 transform -translate-x-1/2 p-3 rounded-lg text-white opacity-0 transition-opacity duration-300 z-50"></div>

  <!-- Main Container -->
  <div id="main-container" class="flex flex-1 overflow-hidden">
    <!-- Left Panel -->
    <div id="left-panel" class="relative flex flex-col w-2/5 min-w-[300px] bg-gray-800 p-2">
      <!-- Toggle Button -->
      <button id="toggle-left-panel" class="absolute top-2 right-[-30px] z-10 bg-gray-700 hover:bg-indigo-600 text-white p-2 rounded-r-lg">
        <i class="fas fa-chevron-left"></i>
      </button>
      <!-- Settings -->
      <div class="settings-panel border border-gray-700 rounded-lg mb-4">
        <button id="toggle-settings" class="w-full flex justify-between items-center p-3 bg-gray-700 hover:bg-gray-600 rounded-t-lg">
          <span><i class="fas fa-cog mr-2"></i>基础设置</span>
          <i id="settings-chevron" class="fas fa-chevron-down transition-transform"></i>
        </button>
        <div id="settings-content" class="overflow-hidden max-h-0 p-0 transition-all duration-300">
          <div class="p-4 space-y-3">
            <div>
              <label for="model-select" class="block text-sm mb-1">选择模型</label>
              <select id="model-select" class="w-full bg-gray-900 border border-gray-600 rounded p-2 focus:ring-indigo-500 focus:border-indigo-500">
                <option value="gpt-4o">GPT-4o</option>
                <option value="gemini-1.5-pro">Gemini 1.5 Pro</option>
                <option value="deepseek-coder">DeepSeek Coder</option>
                <option value="custom">自定义</option>
              </select>
            </div>
            <div>
              <label for="api-url" class="block text-sm mb-1">API URL</label>
              <input id="api-url" type="text" placeholder="https://api.openai.com/v1/chat/completions" class="w-full bg-gray-900 border border-gray-600 rounded p-2 focus:ring-indigo-500 focus:border-indigo-500" />
            </div>
            <div>
              <label for="api-key" class="block text-sm mb-1">API Key</label>
              <input id="api-key" type="password" placeholder="请输入你的 API Key" class="w-full bg-gray-900 border border-gray-600 rounded p-2 focus:ring-indigo-500 focus:border-indigo-500" />
            </div>
          </div>
        </div>
      </div>
      <!-- Original Code Editor -->
      <div class="flex flex-col flex-1 mb-4">
        <label class="font-semibold mb-2">原始代码输入区</label>
        <textarea id="editor-left" class="flex-1 bg-[#1e1e1e] text-gray-200 font-mono border border-gray-700 rounded p-4 resize-none outline-none leading-relaxed" placeholder="在此处粘贴你的原始代码..."></textarea>
      </div>
      <!-- User Request -->
      <div class="flex flex-col">
        <label for="user-request" class="font-semibold mb-2">代码修改需求</label>
        <textarea id="user-request" rows="3" class="w-full bg-gray-700 border border-gray-600 rounded p-3 mb-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="例如：将所有注释翻译成中文"></textarea>
        <button id="generate-btn" class="btn btn-primary w-full inline-flex items-center justify-center py-2 px-4 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition">
          <i class="fas fa-magic mr-2"></i> <span id="generate-btn-text">生成修改</span>
        </button>
      </div>
    </div>

    <!-- Resizable Handle -->
    <div id="resizable-handle" class="cursor-col-resize w-[8px] bg-gray-700 hover:bg-indigo-600 transition-colors flex-shrink-0"></div>

    <!-- Right Panel -->
    <div id="right-panel" class="flex flex-col flex-1 bg-gray-800 p-4 space-y-3">
      <div class="flex justify-between items-center">
        <h2 class="text-lg font-semibold">编辑后代码（可直接修改）</h2>
        <div class="flex items-center space-x-3">
          <div class="relative">
            <select id="history-select" class="bg-gray-700 border border-gray-600 rounded p-2 pr-8 appearance-none focus:ring-indigo-500 focus:border-indigo-500 cursor-pointer">
              <option value="-1">历史版本</option>
            </select>
            <i class="fas fa-history absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"></i>
          </div>
          <button id="copy-btn" class="inline-flex items-center py-2 px-4 bg-gray-600 text-white rounded hover:bg-gray-700 transition">
            <i class="fas fa-copy mr-2"></i> 复制
          </button>
        </div>
      </div>
      <textarea id="editor-right" class="flex-1 bg-[#1e1e1e] text-gray-200 font-mono border border-gray-700 rounded p-4 resize-none outline-none leading-relaxed"></textarea>
    </div>
  </div>

  <!-- Core JS Logic (unchanged) -->
  <script>
// --- Core Application Logic ---
document.addEventListener('DOMContentLoaded', () => {
    const leftPanel = document.getElementById('left-panel');
    const resizableHandle = document.getElementById('resizable-handle');
    const settingsContent = document.getElementById('settings-content');
    const settingsChevron = document.getElementById('settings-chevron');
    const toggleSettingsBtn = document.getElementById('toggle-settings');
    const toggleLeftPanelBtn = document.getElementById('toggle-left-panel');
    let isResizing = false;

    // Toggle settings panel
    toggleSettingsBtn.addEventListener('click', () => {
        const open = settingsContent.classList.toggle('max-h-0');
        if (open) {
            settingsChevron.classList.remove('rotate-180');
            settingsContent.style.padding = '0';
        } else {
            settingsChevron.classList.add('rotate-180');
            settingsContent.style.padding = '';
        }
    });

    // Toggle left panel collapse
    toggleLeftPanelBtn.addEventListener('click', () => {
        leftPanel.classList.toggle('collapsed');
        const icon = toggleLeftPanelBtn.querySelector('i');
        icon.classList.toggle('fa-chevron-left');
        icon.classList.toggle('fa-chevron-right');
    });

    // Panel resizing
    resizableHandle.addEventListener('mousedown', () => {
        isResizing = true;
        document.body.style.cursor = 'col-resize';
    });
    document.addEventListener('mousemove', (e) => {
        if (!isResizing) return;
        const containerRect = document.getElementById('main-container').getBoundingClientRect();
        const newWidth = Math.max(300, e.clientX - containerRect.left);
        leftPanel.style.width = newWidth + 'px';
    });
    document.addEventListener('mouseup', () => {
        isResizing = false;
        document.body.style.cursor = '';
    });
});
</script>
</body>
</html>
